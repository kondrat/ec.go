(function(h){var j=h.tmpl.complete,oldManip=h.fn.domManip;h.tmpl.complete=function(a){var b;j(a);for(b in a){b=a[b];if(b.addedTmplItems&&h.inArray(b,b.addedTmplItems)===-1){b.addedTmplItems.push(b)}}for(b in a){b=a[b];if(b.rendered){b.rendered(b)}}};h.extend({tmplCmd:function(d,e,f){var g=[],before;function find(a,b){var c=[],tmplItem,ti,tl=b.length,dataItem,di=0,dl=a.length;for(;di<dl;){dataItem=a[di++];for(ti=0;ti<tl;){tmplItem=b[ti++];if(tmplItem.data===dataItem){c.push(tmplItem)}}}return c}e=h.isArray(e)?e:[e];switch(d){case"find":return find(e,f);case"replace":e.reverse()}h.each(f?find(e,f):e,function(i,a){coll=a.nodes;switch(d){case"update":a.update();break;case"remove":h(coll).remove();if(f){f.splice(h.inArray(a,f),1)}break;case"replace":before=before?h(coll).insertBefore(before)[0]:h(coll).appendTo(coll[0].parentNode)[0];g.unshift(a)}});return g}});h.fn.extend({domManip:function(b,c,d,e){var f=b[1],tmpl=b[0],dmArgs;if(b.length>=2&&typeof f==="object"&&!f.nodeType&&!(f instanceof h)){dmArgs=h.makeArray(arguments);dmArgs[0]=[h.tmpl(h.template(tmpl),f,b[2],b[3])];dmArgs[2]=function(a){h.tmpl.afterManip(this,a,d)};return oldManip.apply(this,dmArgs)}return oldManip.apply(this,arguments)}})})(jQuery);